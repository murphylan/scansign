# ScanSign - æ‰«ç ç­¾åˆ°ç³»ç»Ÿ

ä¸€ä¸ªåŸºäº H5 é¡µé¢çš„æ‰«ç ç­¾åˆ°ç™»å½•è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒä¼šè®®ç­¾åˆ°ã€å¼¹å¹•æ¬¢è¿ã€å®æ—¶ç”¨æˆ·ç®¡ç†ã€‚

## æŠ€æœ¯æ ˆ

- âš›ï¸ **Framework** - Next.js 16 (App Router)
- ğŸ“ **Language** - TypeScript
- ğŸ¨ **Styling** - Tailwind CSS v4
- ğŸ§© **Components** - Shadcn-ui
- âœ… **Schema Validations** - Zod
- ğŸ—‚ï¸ **State Management** - Zustand

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸ” ç”Ÿæˆå”¯ä¸€ Token çš„äºŒç»´ç 
- ğŸ“± H5 é¡µé¢æ”¶é›†ç”¨æˆ·ä¿¡æ¯ï¼ˆç”¨æˆ·åã€æ‰‹æœºå·ã€éƒ¨é—¨ï¼‰
- ğŸ”„ PC ç«¯å®æ—¶è½®è¯¢æ£€æµ‹ç™»å½•çŠ¶æ€
- â±ï¸ äºŒç»´ç è‡ªåŠ¨è¿‡æœŸæœºåˆ¶ï¼ˆ5åˆ†é’Ÿï¼‰
- ğŸ‰ ä¼šè®®é¦–é¡µå¼¹å¹•æ¬¢è¿æ•ˆæœ
- ğŸ‘¥ åå°å®æ—¶ç”¨æˆ·ç®¡ç†
- ğŸ” è€ç”¨æˆ·è¯†åˆ«ä¸ä¿¡æ¯å›æ˜¾
- ğŸ”‘ **3ä½éªŒè¯ç å®‰å…¨æœºåˆ¶**ï¼Œé˜²æ­¢æ¶æ„ä¿®æ”¹ä»–äººä¿¡æ¯
- âœ¨ ç²¾ç¾çš„æš—è‰²ä¸»é¢˜ UI è®¾è®¡

## é¡µé¢æˆªå›¾

### æ‰«ç ç™»å½•é¡µ

PC ç«¯äºŒç»´ç ç™»å½•å…¥å£

<img src="docs/screenshots/login.png" width="300" alt="æ‰«ç ç™»å½•é¡µ" />

### H5 æ³¨å†Œé¡µé¢

æ‰‹æœºç«¯ä¿¡æ¯å¡«å†™ç•Œé¢

<img src="docs/screenshots/mobile.jpg" width="300" alt="H5æ³¨å†Œé¡µé¢" />

### ä¼šè®®é¦–é¡µ

å¤§å±å±•ç¤ºï¼Œå®æ—¶å¼¹å¹•æ¬¢è¿æ–°ç”¨æˆ·

<img src="docs/screenshots/home.png" width="800" alt="ä¼šè®®é¦–é¡µ" />

### åå°ç®¡ç†

å®æ—¶ç”¨æˆ·åˆ—è¡¨ã€éªŒè¯ç æŸ¥çœ‹å’Œç»Ÿè®¡

<img src="docs/screenshots/admin.png" width="800" alt="åå°ç®¡ç†" />

## ä½¿ç”¨æŒ‡å—

### é¡µé¢ä¸€è§ˆ

| é¡µé¢ | åœ°å€ | è¯´æ˜ |
|------|------|------|
| æ‰«ç ç™»å½• | `/` | PC ç«¯æ‰«ç å…¥å£é¡µé¢ |
| ä¼šè®®é¦–é¡µ | `/home` | æ˜¾ç¤ºä¼šè®®ä¸»é¢˜å’Œæ¬¢è¿å¼¹å¹• |
| ç”¨æˆ·æ³¨å†Œ | `/mobile/confirm?token=xxx` | æ‰‹æœºç«¯ä¿¡æ¯å¡«å†™é¡µé¢ |
| åå°ç®¡ç† | `/admin` | å®æ—¶æŸ¥çœ‹æ³¨å†Œç”¨æˆ·åˆ—è¡¨å’ŒéªŒè¯ç  |

### å®Œæ•´ä½¿ç”¨æµç¨‹

#### 1ï¸âƒ£ ç®¡ç†å‘˜å‡†å¤‡

1. å¯åŠ¨æœåŠ¡åï¼Œåœ¨å¤§å±å¹•ä¸Šæ‰“å¼€ **ä¼šè®®é¦–é¡µ** (`/home`)
2. å¦å¼€ä¸€ä¸ªæµè§ˆå™¨çª—å£æ‰“å¼€ **åå°ç®¡ç†** (`/admin`) ç›‘æ§æ³¨å†Œæƒ…å†µ

#### 2ï¸âƒ£ ç”¨æˆ·ç­¾åˆ°

1. ç”¨æˆ·åœ¨è‡ªå·±çš„ç”µè„‘/å¹³æ¿ä¸Šè®¿é—® **æ‰«ç ç™»å½•é¡µ** (`/`)
2. ä½¿ç”¨å¾®ä¿¡æ‰«æé¡µé¢ä¸Šçš„äºŒç»´ç 
3. æ‰‹æœºä¸Šæ‰“å¼€ H5 é¡µé¢ï¼Œå¡«å†™ä¿¡æ¯ï¼š
   - ğŸ“± æ‰‹æœºå·ç 
   - ğŸ‘¤ ç”¨æˆ·å
   - ğŸ¢ æ‰€å±éƒ¨é—¨
4. ç‚¹å‡»ã€Œç¡®è®¤æ³¨å†Œã€å®Œæˆç­¾åˆ°

#### 3ï¸âƒ£ ç­¾åˆ°æˆåŠŸ

- **æ‰‹æœºç«¯**ï¼šæ˜¾ç¤º "xxx ç­¾åˆ°æˆåŠŸ" å’Œ **ä¸“å±3ä½éªŒè¯ç **
- **ä¼šè®®é¦–é¡µ**ï¼šæ»šåŠ¨æ˜¾ç¤º "ğŸ‰ æ¬¢è¿ xxx åŠ å…¥ï¼" å¼¹å¹•
- **åå°ç®¡ç†**ï¼šå®æ—¶æ˜¾ç¤ºæ–°æ³¨å†Œç”¨æˆ·ï¼Œå¹¶å¼¹å‡ºæé†’

> âš ï¸ **é‡è¦æç¤º**ï¼šè¯·ç”¨æˆ·ç‰¢è®°è‡ªå·±çš„3ä½éªŒè¯ç ï¼Œä¿®æ”¹ä¿¡æ¯æ—¶éœ€è¦éªŒè¯ï¼

#### 4ï¸âƒ£ è€ç”¨æˆ·å†æ¬¡ç­¾åˆ°

1. è¾“å…¥æ‰‹æœºå·åè‡ªåŠ¨è¯†åˆ«ä¸ºè€ç”¨æˆ·
2. å›æ˜¾ä¸Šæ¬¡æ³¨å†Œçš„ç”¨æˆ·åå’Œéƒ¨é—¨
3. **è¾“å…¥é¦–æ¬¡ç­¾åˆ°æ—¶è·å¾—çš„3ä½éªŒè¯ç **
4. éªŒè¯é€šè¿‡åå¯ä¿®æ”¹ç”¨æˆ·åã€éƒ¨é—¨ç­‰ä¿¡æ¯
5. æäº¤åæ˜¾ç¤º "xxx ä¿®æ”¹æˆåŠŸ"

### å®‰å…¨ä¸é˜²é‡å¤æœºåˆ¶

- **æ‰‹æœºå·å”¯ä¸€**ï¼šåŒä¸€æ‰‹æœºå·åªèƒ½æ³¨å†Œä¸€æ¬¡ï¼Œå†æ¬¡æ‰«ç æ˜¾ç¤ºå·²æœ‰ä¿¡æ¯
- **ç”¨æˆ·å+éƒ¨é—¨å”¯ä¸€**ï¼šåŒä¸€éƒ¨é—¨å†…ä¸å…è®¸é‡å
- **éªŒè¯ç ä¿æŠ¤**ï¼š
  - é¦–æ¬¡ç­¾åˆ°æ—¶ç³»ç»Ÿç”Ÿæˆéšæœº3ä½éªŒè¯ç 
  - è€ç”¨æˆ·ä¿®æ”¹ä¿¡æ¯å¿…é¡»è¾“å…¥æ­£ç¡®çš„éªŒè¯ç 
  - é˜²æ­¢ä»–äººé€šè¿‡æ‰‹æœºå·æ¶æ„ä¿®æ”¹åˆ«äººçš„ä¿¡æ¯
  - å¿˜è®°éªŒè¯ç å¯è”ç³»ç®¡ç†å‘˜åœ¨åå°æŸ¥çœ‹

## å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
npm install
```

### å¼€å‘æ¨¡å¼

```bash
npm run dev
```

è®¿é—® http://localhost:3000 æŸ¥çœ‹ç™»å½•é¡µé¢

### ç”Ÿäº§æ„å»º

```bash
npm run build
npm run start
```

## é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ qrcode/
â”‚   â”‚   â”‚   â”œâ”€â”€ generate/        # ç”ŸæˆäºŒç»´ç 
â”‚   â”‚   â”‚   â”œâ”€â”€ status/[token]/  # æŸ¥è¯¢ç™»å½•çŠ¶æ€
â”‚   â”‚   â”‚   â””â”€â”€ confirm/         # ç¡®è®¤ç™»å½•
â”‚   â”‚   â”œâ”€â”€ user/
â”‚   â”‚   â”‚   â”œâ”€â”€ check/           # æ£€æŸ¥æ‰‹æœºå·æ˜¯å¦å·²æ³¨å†Œ
â”‚   â”‚   â”‚   â”œâ”€â”€ check-username/  # æ£€æŸ¥ç”¨æˆ·åé‡å¤
â”‚   â”‚   â”‚   â”œâ”€â”€ list/            # è·å–ç”¨æˆ·åˆ—è¡¨
â”‚   â”‚   â”‚   â””â”€â”€ stream/          # SSE å®æ—¶æ¨é€
â”‚   â”‚   â””â”€â”€ departments/         # è·å–éƒ¨é—¨åˆ—è¡¨
â”‚   â”œâ”€â”€ home/                    # ä¼šè®®é¦–é¡µï¼ˆå¼¹å¹•ï¼‰
â”‚   â”œâ”€â”€ admin/                   # åå°ç®¡ç†é¡µé¢
â”‚   â”œâ”€â”€ mobile/confirm/          # H5 ä¿¡æ¯æ”¶é›†é¡µé¢
â”‚   â”œâ”€â”€ success/                 # ç™»å½•æˆåŠŸé¡µé¢
â”‚   â”œâ”€â”€ page.tsx                 # PC ç«¯æ‰«ç ç™»å½•é¡µé¢
â”‚   â”œâ”€â”€ layout.tsx
â”‚   â””â”€â”€ globals.css
â”œâ”€â”€ components/ui/               # Shadcn-ui ç»„ä»¶
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ utils.ts                 # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ session-store.ts         # ä¼šè¯å­˜å‚¨ï¼ˆå†…å­˜ï¼‰
â”‚   â””â”€â”€ user-store.ts            # ç”¨æˆ·å­˜å‚¨ï¼ˆå†…å­˜ï¼‰
â”œâ”€â”€ store/
â”‚   â””â”€â”€ login-store.ts           # Zustand çŠ¶æ€ç®¡ç†
â””â”€â”€ types/
    â””â”€â”€ index.ts                 # TypeScript ç±»å‹å®šä¹‰
```

## API æ¥å£

### äºŒç»´ç ç›¸å…³

#### POST /api/qrcode/generate
ç”Ÿæˆæ–°çš„äºŒç»´ç 

**å“åº”:**
```json
{
  "success": true,
  "data": {
    "token": "uuid-string",
    "qrCodeUrl": "data:image/png;base64,...",
    "expiresAt": 1702547200000
  }
}
```

#### GET /api/qrcode/status/[token]
æŸ¥è¯¢ç™»å½•çŠ¶æ€

**å“åº”:**
```json
{
  "success": true,
  "data": {
    "status": "pending | confirmed | expired",
    "userInfo": {
      "username": "ç”¨æˆ·å",
      "phone": "13800138000",
      "departmentId": "tech",
      "departmentName": "æŠ€æœ¯éƒ¨",
      "isNewUser": true,
      "submittedAt": 1702547200000
    }
  }
}
```

#### POST /api/qrcode/confirm
ç¡®è®¤ç™»å½•å¹¶æäº¤ç”¨æˆ·ä¿¡æ¯

**è¯·æ±‚ä½“:**
```json
{
  "token": "uuid-string",
  "username": "ç”¨æˆ·å",
  "phone": "13800138000",
  "departmentId": "tech",
  "existingUserId": "å¯é€‰ï¼Œè€ç”¨æˆ·æ›´æ–°æ—¶ä¼ å…¥",
  "verifyCode": "å¯é€‰ï¼Œè€ç”¨æˆ·ä¿®æ”¹æ—¶å¿…å¡«ï¼Œ3ä½æ•°å­—éªŒè¯ç "
}
```

**å“åº”:**
```json
{
  "success": true,
  "data": {
    "message": "ç­¾åˆ°æˆåŠŸ",
    "userId": "user_xxx",
    "verifyCode": "123"  // ä»…æ–°ç”¨æˆ·é¦–æ¬¡ç­¾åˆ°æ—¶è¿”å›
  }
}
```

### ç”¨æˆ·ç›¸å…³

#### POST /api/user/check
æ£€æŸ¥æ‰‹æœºå·æ˜¯å¦å·²æ³¨å†Œ

#### POST /api/user/check-username
æ£€æŸ¥ç”¨æˆ·å+éƒ¨é—¨æ˜¯å¦é‡å¤

#### GET /api/user/list
è·å–ç”¨æˆ·åˆ—è¡¨

#### GET /api/user/stream
SSE å®æ—¶æ¨é€ç”¨æˆ·æ³¨å†Œ/æ›´æ–°äº‹ä»¶

#### GET /api/departments
è·å–éƒ¨é—¨åˆ—è¡¨

## ç¯å¢ƒå˜é‡

```env
# åº”ç”¨åŸºç¡€URLï¼ˆç”¨äºç”ŸæˆäºŒç»´ç ä¸­çš„H5é“¾æ¥ï¼‰
NEXT_PUBLIC_BASE_URL=http://localhost:3000
```

## ç”Ÿäº§ç¯å¢ƒæ³¨æ„äº‹é¡¹

1. **æ•°æ®å­˜å‚¨**: å½“å‰ä½¿ç”¨å†…å­˜å­˜å‚¨ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ Redis æˆ–æ•°æ®åº“
2. **åŸŸåé…ç½®**: éœ€è¦é…ç½®æ­£ç¡®çš„ `NEXT_PUBLIC_BASE_URL`
3. **HTTPS**: ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨ HTTPS
4. **è·¨åŸŸé…ç½®**: åœ¨ `next.config.ts` ä¸­é…ç½® `allowedDevOrigins`
5. **ç”¨æˆ·éªŒè¯**: å¯æ ¹æ®éœ€æ±‚æ·»åŠ çŸ­ä¿¡éªŒè¯ç ç­‰é¢å¤–éªŒè¯

## è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹ä¼šè®®ä¸»é¢˜

ç¼–è¾‘ `src/app/home/page.tsx` ä¸­çš„æ ‡é¢˜å†…å®¹ï¼š

```tsx
<h1>å˜‰å¹´å</h1>
<p>å¹´åº¦ç››å…¸ Â· å…±åˆ›æœªæ¥</p>
```

### ä¿®æ”¹éƒ¨é—¨åˆ—è¡¨

ç¼–è¾‘ `src/lib/user-store.ts` ä¸­çš„ `DEPARTMENTS` æ•°ç»„ï¼š

```typescript
export const DEPARTMENTS: Department[] = [
  { id: "tech", name: "æŠ€æœ¯éƒ¨" },
  { id: "product", name: "äº§å“éƒ¨" },
  // æ·»åŠ æ›´å¤šéƒ¨é—¨...
];
```

## License

MIT
